\documentclass[conference, a4paper]{IEEEtran}

% used for flow charts
\usepackage{pgf}
\usepackage{tikz}
\usepackage{reotex}

\usepackage{amssymb}
\usepackage{cite}
\usepackage[normalem]{ulem}
% FIXME finally no todos should exist in this draft
\usepackage[textsize=tiny]{todonotes}
% positioning is used for below lef = of
\usetikzlibrary{shapes,arrows,automata,positioning}
% some tikz-styles on reo channels, not required in papers that have nothing to do with Reo

% declaration of environments
\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}


\title{Active Learning : From Blackbox To Timed Connectors}
\author{
\IEEEauthorblockN{Yi Li\IEEEauthorrefmark{1} and Meng Sun\IEEEauthorrefmark{1}}
\IEEEauthorblockA{
  \IEEEauthorrefmark{1}DI, School of Mathematical Sciences, Peking University,
  Beijing, China\\
  liyi\_math@pku.edu.cn, summeng@math.pku.edu.cn
}
}

\begin{document}
\maketitle
\begin{abstract}
  Coordination is becoming more and more important, especially in concurrent programming and
  distributed systems. More and more tools are built to verify coordination models while most of
  them are facing the same problem: \emph{lack of models}. In many cases, somehow we need to check a
  connector with nothing more than a binary file. In this paper, we present a learning-based
  framework to formally verify a Reo connector in case there is no source code. From some practical
  cases, we've shown the effciency of our approach. Both the algorithm and Reo itself have been
  ported to \emph{Golang}, making it fully-prepared for parallel programming.
\end{abstract}

\begin{IEEEkeywords}
  active learning, coordination, formal method.
\end{IEEEkeywords}

\section{Introduction}

In the past few years, researchers have been focusing on this area, and come up with a
series of impressive works. 
\todo{a list}
However, most of these works are based on models, instead of binaries. Then it comes a well-known
problem: \emph{how can we obtain these models?}

To solve this problem, many techniques in model constructing were proposed, for instance in
\cite{DBLP:journals/mt/Daelemans10, DBLP:journals/iandc/Angluin87, DBLP:conf/fase/RaffeltS06}.

% it seems that we need a graph to describe how we're doing this work
\todo{better graph}
\input{images/flow.tex}

In this paper, we presented an adapted active learning algorithm to extract timed Reo connectors
from binaries with no source code needed.

\section{Preliminaries}

\subsection{Reo Coordination Language}
\label{sec:reo}

\begin{figure}[h]
  \begin{center}
    \input{./images/basic.tex}
  \end{center}
  \caption{Basic Reo Channels}
  \label{fig:basic}
\end{figure}

\subsection{Active Learning and Mealy Machines}

\section{Timed Connectors as Mealy Machines}

Reo Coordination Model, obviously, is not a \emph{proper model} for learning. 

So far as we can tell, most works\cite{DBLP:conf/fase/RaffeltS06} on automata learning are not
capable of infinite models. \todo{reason?} Considering the semantics defined in section
\ref{sec:reo}, it's apparent that every finite connector has a corresponding constraint
automata, and the automata is also finite. Unfortunately, when checking the further definition of
Reo connectors' input, we find that it's not the case.

\todo{an example as graph}

\begin{figure}[h]
  \caption{Infinite States in a Reo Model}
  \label{fig:reoinfinite}
\end{figure}

While focusing on behavior of connectors, Reo doesn't give detail depiction on behavior of
components. As shown in \figurename \ref{fig:reoinfinite}, connectors are able to reject any datum
if they are not ready. But what will happen outside the connector, if the datum is rejected? This
question deserves careful consideration if we are taking an external view.

\subsection{Parameterized Mealy Machine}
\begin{definition}[Parameterized Mealy Machine]
  A \emph{Parameterized Mealy Machine} is defined as a function $\mathcal{PM}(\Sigma)=\langle
  S(\Sigma), s_0, I(\Sigma), O(\Sigma), \delta(\Sigma), \lambda(\Sigma)\rangle$ that maps an
  alphabet to its corresponding Mealy Machine. 
  \begin{itemize}
    \item[-] $\Sigma$ is a \emph{finite} datum alphabet (hereafter referred to as an alphabet)
    \item[-] $S$ is a function that maps an alphabet to a \emph{finite} set of
      states. We use $S(\Sigma)$ to denote the state set.
    \item[-] $I(\Sigma)$ maps an alphabet to a set of input actions.
    \item[-] $O(\Sigma)$ maps an alphabet to a set of output actions.
    \item[-] $s_0$ is the initial state. It satisfies $\forall \Sigma,s_0\in S(\Sigma)$
    \item[-] $\delta$ maps a \emph{finite} datum alphabet to an \emph{output function}. We use
      $\delta(\Sigma):S(\Sigma)\times I(\Sigma)\rightarrow O(\Sigma)$ to denote the output function.
    \item[-] $\lambda$ maps an alphabet to a \emph{transition function}. We use
      $\lambda(\Sigma):S(\Sigma)\times I(\Sigma)\rightarrow S(\Sigma)$ to denote the transiton
      function.
  \end{itemize}
\end{definition}

Now we can use Parameterized Mealy Machines to define a new semantics to Reo.
\begin{example}[PMM Semantics of FIFO channel $PM_{FIFO}$]
  The semantics of FIFO channel with source end $A$ and sink end $B$ can be defined as follows
  \begin{itemize}
    \item[-] $S(\Sigma)=\{q_0\}\cup\{q_d|d\in\Sigma\}$
    \item[-] $I(\Sigma)=\{(A:d)|d\in\Sigma\cup \{\bot\}\}$
    \item[-] $O(\Sigma)=\{(B:d)|d\in\Sigma\cup\{\bot\}\}$
    \item[-] transition function
      \begin{displaymath}
        \delta(\Sigma)(s,i)=\left\{
        \begin{array}[h]{ll}
          q_d & s=q_0\land i=(A:d) \\
          q_d & s=q_{d'}\land i=(A:d) \\
          q_0 & s=q_d\land i=(A:\bot) \\
        \end{array}
        \right.
      \end{displaymath}
    \item[-] output function
      \begin{displaymath}
        \delta(\Sigma)(s,i)=\left\{
        \begin{array}[h]{ll}
          q_d & s=q_0\land i=(A:d) \\
          q_d & s=q_{d'}\land i=(A:d) \\
          q_0 & s=q_d\land i=(A:\bot) \\
        \end{array}
        \right.
      \end{displaymath}
  \end{itemize}
\end{example}

\begin{figure}[h]
  \begin{center}
    \input{./images/pmmfifo.tex}
  \end{center}
  \caption{PMM-based Semantics of FIFO, where $\Sigma=\{a,b\}$}
  \label{fig:pmmfifo}
\end{figure}

\todo{finish the definition ..}
\begin{definition}[Production of Parameterized Mealy Machines]
  Now we're going to define the production of two parameterized mealy Machine
  \[
  Prod(PM_1,PM_2)=PM_3
  \]
  as follows,
  \begin{itemize}
    \item[-] $\forall\Sigma,PM_3.I(\Sigma)=PM_1.I(\Sigma)\cup PM_2.I(\Sigma)$
    \item
  \end{itemize}
\end{definition}

\section{From Blackbox to Timed Connectors}
\subsection{Equivalence Query}
Generally, equivalence query has been proved impossible in blackbox
models\cite{DBLP:journals/iandc/Angluin87}. However, in this
section, we're showing that in certain circumstances, equivalence query can be implemented with
no approximation.

Equivalence queries are used to search for counter-examples. But what makes counter-examples even
existing? In Reo models, we believe that \emph{FIFO} channels and \emph{Timer} channels are to
blame. Here we present a brief example. To make things eaiser, we have only untimed Reo here.

\begin{figure}[h]
  \begin{center}
    \input{./images/3buf.tex}
  \end{center}
  \caption{A Switching Connector $S$ with Three Buffers}
  \label{fig:buf3}
\end{figure}

A \emph{Switching} connector in \figurename \ref{fig:buf3} has two source-ends $A,B$ and one
sink-end $C$. In a nutshell, datum come from $A$ and be stored temporarily in buffers. These datum
will never flow out until signals come to $B$. With the Mealy-Machine semantics given, the semantics
of \emph{Switching} connectors can be defined as following \figurename \ref{fig:buf3semantics}.

\begin{figure}[h]
  \begin{center}
    \input{./images/3bufsemantics.tex}
  \end{center}
  \caption{\emph{Gate} as Mealy Machine $\mathcal{M}(S)$}
  \label{fig:buf3semantics}
\end{figure}

According to the production of Mealy-Machines, 8 different states should be found in
$\mathcal{M}(S)$. We use $q_{abc}$ to denote them. $q_{001}$ indicates that the last buffer is
filled and others are empty, and $q_{111}$ means that there are no space in any buffer. It's
obvious that some states like $q_{100}$ is unreachable.

\begin{definition}[Similar]
  In a mealy machine, two states are similar iff. they have the same output signature.
\end{definition}

\begin{theorem}[Bound of Counter-Example]
  \label{the:cebound} Assume that an observation table has already been closed with maximum
  query length \todo{find a better phrase?} $l$. An counter-example of length $l+2$ would be
  found iff. there're possible counter-examples.
\end{theorem}
\begin{IEEEproof}
  Sketch of this proof are shown in several points:
  \begin{enumerate}
    \item Hypothesises are subgraphs of the semantics graph.
    \item Inputs on reverse edges are complementary.
    \item 
  \end{enumerate}
\end{IEEEproof}

\section{Case Studies}

\section{Conclusion and Future Work}



\bibliographystyle{abbrv}
\bibliography{bib}

% FIXME remove this
\listoftodos

\end{document}
